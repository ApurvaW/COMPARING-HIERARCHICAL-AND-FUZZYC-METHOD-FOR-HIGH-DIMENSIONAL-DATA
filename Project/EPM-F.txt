> library(cluster)
> library(ggplot2)
> library(factoextra)
> library(colorspace)
> library(dendextend)
> library(readxl)
> final_grades <- read_excel("~/Masters Projet/EPM/Data/final_grades.xlsx")
> View(final_grades)
> pca <- princomp(final_grades[, 2:18], cor=T) # principal components analysis using correlation matrix
> pc.comp <- pca$scores
> PrincipalComponent1 <- -1*pc.comp[,1] # principal component 1 scores (negated for convenience)
> PrincipalComponent2 <- -1*pc.comp[,2]
> clustering.data <- cbind(PrincipalComponent1, PrincipalComponent2)
> plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> 
> #ward.D Link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "ward.D")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 1 2 3 1 3 3 4 5 3 2 3 1 4 6 1 5 7 6 4 3 7 3 7 5 5 3 7 1 4 1 1 4 7 7 4 3 1 2 1 4 2
[43] 4 7 7 3 1 3 7 1 7 2
> table(clusterCut, final_grades$`Student ID`)
          
clusterCut 3 6 7 10 13 15 16 17 18 20 24 27 28 29 30 32 36 37 39 41 44 46 48 51 53 56 59
         1 1 1 0  0  1  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  0  0
         2 0 0 1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
         3 0 0 0  1  0  1  1  0  0  1  0  1  0  0  0  0  0  0  0  0  1  0  1  0  0  0  1
         4 0 0 0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0
         5 0 0 0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  1  0
         6 0 0 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0
         7 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  1  0  0  0
          
clusterCut 62 63 66 67 68 72 73 74 76 78 81 83 85 86 87 88 89 92 93 96 98 99 100 101 106
         1  0  1  0  1  1  0  0  0  0  0  1  0  1  0  0  0  0  0  0  1  0  0   1   0   0
         2  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0   0   0   1
         3  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0   0   0   0
         4  0  0  1  0  0  1  0  0  1  0  0  0  0  1  0  1  0  0  0  0  0  0   0   0   0
         5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         7  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  1  0  0  0  1   0   1   0
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1                   2.0                   3.0             1.583333
2       2                   2.0                   3.0             1.400000
3       3                   2.0                   3.0             1.454545
4       4                   2.0                   3.0             1.750000
5       5                   1.5                   3.0             1.500000
6       6                   1.0                   1.5             2.000000
7       7                   1.8                   2.6             0.850000
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1             1.791667                  1.0                 2.00             2.000000
2             0.900000                  1.0                 2.00             1.200000
3             1.454545                  1.0                 2.00             1.636364
4             2.062500                  1.0                 2.00             2.000000
5             1.500000                  1.0                 1.75             1.500000
6             0.000000                  0.0                 0.00             0.000000
7             0.100000                  0.9                 2.00             0.400000
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.791667             2.750000              13.75000              8.291667
2             1.600000             2.400000               5.00000              3.200000
3             2.000000             2.863636              10.09091              7.272727
4             2.000000             2.875000              14.75000              9.625000
5             1.500000             2.250000              14.50000              8.250000
6             1.000000             0.000000               3.00000              3.000000
7             1.400000             1.500000               2.50000              2.200000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1            1.9166667              6.666667             2.750000              17.08333
2            0.4000000              0.800000             1.500000               8.40000
3            0.8181818              3.500000             1.954545              11.90909
4            1.8750000              8.875000             3.000000              23.75000
5            1.5000000              6.125000             1.875000              12.75000
6            0.0000000              0.000000             0.000000               5.00000
7            0.0000000              0.000000             0.150000               0.30000
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1              11.08333              79.45833
2               7.60000              42.40000
3              10.54545              63.50000
4              14.00000              94.56250
5              10.25000              70.75000
6               7.50000              24.00000
7               0.50000              17.20000
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "ward.D Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #ward.D2 Link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "ward.D2")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 1 2 3 4 1 3 4 1 3 2 3 1 4 5 1 1 6 7 4 3 6 1 6 1 1 3 6 1 4 1 1 4 6 6 4 3 1 2 1 4 2
[43] 4 6 6 3 1 3 6 1 6 2
> table(clusterCut, final_grades$`Student ID`)
          
clusterCut 3 6 7 10 13 15 16 17 18 20 24 27 28 29 30 32 36 37 39 41 44 46 48 51 53 56 59
         1 1 1 0  0  0  1  0  0  1  0  0  0  1  0  0  1  1  0  0  0  0  0  1  0  1  1  0
         2 0 0 1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
         3 0 0 0  1  0  0  1  0  0  1  0  1  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1
         4 0 0 0  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0
         5 0 0 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
         6 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  1  0  0  0
         7 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
          
clusterCut 62 63 66 67 68 72 73 74 76 78 81 83 85 86 87 88 89 92 93 96 98 99 100 101 106
         1  0  1  0  1  1  0  0  0  0  0  1  0  1  0  0  0  0  0  0  1  0  0   1   0   0
         2  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0   0   0   1
         3  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0   0   0   0
         4  0  0  1  0  0  1  0  0  1  0  0  0  0  1  0  1  0  0  0  0  0  0   0   0   0
         5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         6  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  1  0  0  0  1   0   1   0
         7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1              1.882353                   3.0             1.529412
2       2              2.000000                   3.0             1.400000
3       3              2.000000                   3.0             1.444444
4       4              2.000000                   3.0             1.777778
5       5              0.000000                   0.0             2.000000
6       6              1.800000                   2.6             0.850000
7       7              2.000000                   3.0             2.000000
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1             1.823529                  1.0             1.941176             1.882353
2             0.900000                  1.0             2.000000             1.200000
3             1.222222                  1.0             2.000000             1.555556
4             2.000000                  1.0             2.000000             2.000000
5             0.000000                  0.0             0.000000             0.000000
6             0.100000                  0.9             2.000000             0.400000
7             0.000000                  0.0             0.000000             0.000000
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.735294             2.647059              14.02941              8.205882
2             1.600000             2.400000               5.00000              3.200000
3             2.000000             2.833333               9.00000              7.000000
4             2.000000             2.888889              14.72222              9.666667
5             0.000000             0.000000               3.00000              2.000000
6             1.400000             1.500000               2.50000              2.200000
7             2.000000             0.000000               3.00000              4.000000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1            1.7058824              6.411765             2.411765              14.29412
2            0.4000000              0.800000             1.500000               8.40000
3            0.7777778              3.555556             2.000000              13.22222
4            1.8888889              8.111111             3.000000              23.88889
5            0.0000000              0.000000             0.000000               0.00000
6            0.0000000              0.000000             0.150000               0.30000
7            0.0000000              0.000000             0.000000              10.00000
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1             11.117647              75.61765
2              7.600000              42.40000
3              9.555556              62.16667
4             14.111111              94.05556
5              0.000000               7.00000
6              0.500000              17.20000
7             15.000000              41.00000
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "ward.D2 Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #Single link
> d <- dist(clustering.data)
> hclusters <- hclust(d , method = "single")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 3 4 1 1 5 1 3 1 1 1 6 1 1 1 1 1 6 5 1 1 1 7 1 1 1
[43] 1 6 5 1 1 1 5 1 6 1
> table(clusterCut, final_grades$`Student Id`)
Error in table(clusterCut, final_grades$`Student Id`) : 
  all arguments must have the same length
In addition: Warning message:
Unknown or uninitialised column: 'Student Id'. 
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1              1.948718                  3.00             1.538462
2       2              0.000000                  0.00             2.000000
3       3              1.750000                  1.50             0.500000
4       4              2.000000                  3.00             2.000000
5       5              1.625000                  2.75             0.875000
6       6              2.000000                  3.00             1.000000
7       7              2.000000                  3.00             2.000000
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1             1.653846                  1.0             1.974359             1.794872
2             0.000000                  0.0             0.000000             0.000000
3             0.000000                  0.5             2.000000             1.000000
4             0.000000                  0.0             0.000000             0.000000
5             0.000000                  1.0             2.000000             0.000000
6             0.250000                  1.0             2.000000             0.500000
7             0.000000                  1.0             2.000000             0.000000
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.833333             2.782051              12.15385               7.75641
2             0.000000             0.000000               3.00000               2.00000
3             2.000000             0.000000               4.00000               0.50000
4             2.000000             0.000000               3.00000               4.00000
5             1.500000             0.750000               2.00000               2.25000
6             1.000000             3.000000               2.25000               3.00000
7             2.000000             0.000000               3.00000               3.00000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1             1.358974              5.487179             2.358974              15.61538
2             0.000000              0.000000             0.000000               0.00000
3             0.000000              0.000000             0.000000               0.00000
4             0.000000              0.000000             0.000000              10.00000
5             0.000000              0.000000             0.000000               0.00000
6             0.000000              0.000000             0.375000               0.75000
7             2.000000              4.000000             1.500000              10.00000
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1              11.28205              73.53846
2               0.00000               7.00000
3               0.00000              13.75000
4              15.00000              41.00000
5               0.00000              14.75000
6               1.25000              21.37500
7               0.00000              35.50000
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "Single Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #Complete link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "complete")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 2 3 3 2 1 3 2 1 3 3 3 1 2 4 1 1 5 6 2 3 7 1 5 1 1 3 7 1 2 1 1 2 7 7 2 1 1 3 1 2 3
[43] 2 7 7 3 1 1 7 1 7 3
> table(clusterCut, final_grades$`Student Id`)
Error in table(clusterCut, final_grades$`Student Id`) : 
  all arguments must have the same length
In addition: Warning message:
Unknown or uninitialised column: 'Student Id'. 
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1              1.888889                 3.000             1.444444
2       2              2.000000                 3.000             1.800000
3       3              2.000000                 3.000             1.500000
4       4              0.000000                 0.000             2.000000
5       5              1.750000                 1.500             0.500000
6       6              2.000000                 3.000             2.000000
7       7              1.812500                 2.875             0.937500
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1            1.7777778                  1.0             1.944444             1.888889
2            2.1000000                  1.0             2.000000             2.000000
3            0.9583333                  1.0             2.000000             1.333333
4            0.0000000                  0.0             0.000000             0.000000
5            0.0000000                  0.5             2.000000             1.000000
6            0.0000000                  0.0             0.000000             0.000000
7            0.1250000                  1.0             2.000000             0.250000
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.861111             2.666667              13.97222              8.138889
2             1.800000             2.900000              14.75000              9.400000
3             1.833333             2.625000               6.50000              5.416667
4             0.000000             0.000000               3.00000              2.000000
5             2.000000             0.000000               4.00000              0.500000
6             2.000000             0.000000               3.00000              4.000000
7             1.250000             1.875000               2.12500              2.625000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1            1.6111111              6.055556             2.277778              14.69444
2            1.9000000              8.200000             3.000000              22.80000
3            0.5833333              2.250000             1.875000              10.54167
4            0.0000000              0.000000             0.000000               0.00000
5            0.0000000              0.000000             0.000000               0.00000
6            0.0000000              0.000000             0.000000              10.00000
7            0.0000000              0.000000             0.187500               0.37500
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1             10.666667              74.88889
2             14.200000              92.85000
3              8.833333              52.25000
4              0.000000               7.00000
5              0.000000              13.75000
6             15.000000              41.00000
7              0.625000              18.06250
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "Complete Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #Average Link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "average")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 2 3 3 2 1 1 2 1 3 3 3 1 2 4 1 1 5 6 2 3 7 1 5 1 1 3 7 1 2 1 1 2 7 7 2 1 1 3 1 2 3
[43] 2 7 7 3 1 1 7 1 7 3
> table(clusterCut, final_grades$`Student ID`)
          
clusterCut 3 6 7 10 13 15 16 17 18 20 24 27 28 29 30 32 36 37 39 41 44 46 48 51 53 56 59
         1 1 0 0  0  0  1  1  0  1  0  0  0  1  0  0  1  1  0  0  0  0  0  1  0  1  1  0
         2 0 1 0  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0
         3 0 0 1  1  0  0  0  0  0  1  1  1  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1
         4 0 0 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
         5 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
         6 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
         7 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
          
clusterCut 62 63 66 67 68 72 73 74 76 78 81 83 85 86 87 88 89 92 93 96 98 99 100 101 106
         1  0  1  0  1  1  0  0  0  0  1  1  0  1  0  0  0  0  0  0  1  1  0   1   0   0
         2  0  0  1  0  0  1  0  0  1  0  0  0  0  1  0  1  0  0  0  0  0  0   0   0   0
         3  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  1  0  0  0   0   0   1
         4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         7  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  1  0  0  0  1   0   1   0
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1              1.894737                 3.000             1.421053
2       2              2.000000                 3.000             1.800000
3       3              2.000000                 3.000             1.545455
4       4              0.000000                 0.000             2.000000
5       5              1.750000                 1.500             0.500000
6       6              2.000000                 3.000             2.000000
7       7              1.812500                 2.875             0.937500
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1             1.684211                  1.0             1.947368             1.894737
2             2.100000                  1.0             2.000000             2.000000
3             1.045455                  1.0             2.000000             1.272727
4             0.000000                  0.0             0.000000             0.000000
5             0.000000                  0.5             2.000000             1.000000
6             0.000000                  0.0             0.000000             0.000000
7             0.125000                  1.0             2.000000             0.250000
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.868421             2.684211             13.394737              8.184211
2             1.800000             2.900000             14.750000              9.400000
3             1.818182             2.590909              6.818182              5.090909
4             0.000000             0.000000              3.000000              2.000000
5             2.000000             0.000000              4.000000              0.500000
6             2.000000             0.000000              3.000000              4.000000
7             1.250000             1.875000              2.125000              2.625000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1            1.5789474              5.736842             2.315789             14.973684
2            1.9000000              8.200000             3.000000             22.800000
3            0.5454545              2.454545             1.772727              9.681818
4            0.0000000              0.000000             0.000000              0.000000
5            0.0000000              0.000000             0.000000              0.000000
6            0.0000000              0.000000             0.000000             10.000000
7            0.0000000              0.000000             0.187500              0.375000
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1             10.894737              74.47368
2             14.200000              92.85000
3              8.272727              50.90909
4              0.000000               7.00000
5              0.000000              13.75000
6             15.000000              41.00000
7              0.625000              18.06250
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "Average Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #Mcquitty Link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "mcquitty")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 1 2 3 1 3 3 1 3 3 2 3 1 1 4 1 3 5 6 1 3 7 3 5 3 3 3 7 1 1 1 1 1 7 7 1 3 1 2 1 1 2
[43] 1 7 7 3 1 3 7 1 7 2
> table(clusterCut, final_grades$`Student ID`)
          
clusterCut 3 6 7 10 13 15 16 17 18 20 24 27 28 29 30 32 36 37 39 41 44 46 48 51 53 56 59
         1 1 1 0  0  1  0  0  1  0  0  0  0  1  1  0  1  0  0  0  1  0  0  0  0  0  0  0
         2 0 0 1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
         3 0 0 0  1  0  1  1  0  1  1  0  1  0  0  0  0  1  0  0  0  1  0  1  0  1  1  1
         4 0 0 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
         5 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
         6 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
         7 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
          
clusterCut 62 63 66 67 68 72 73 74 76 78 81 83 85 86 87 88 89 92 93 96 98 99 100 101 106
         1  0  1  1  1  1  1  0  0  1  0  1  0  1  1  0  1  0  0  0  1  0  0   1   0   0
         2  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0   0   0   1
         3  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0   0   0   0
         4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         7  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  1  0  0  0  1   0   1   0
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1              2.000000                 3.000             1.650000
2       2              2.000000                 3.000             1.400000
3       3              1.866667                 3.000             1.466667
4       4              0.000000                 0.000             2.000000
5       5              1.750000                 1.500             0.500000
6       6              2.000000                 3.000             2.000000
7       7              1.812500                 2.875             0.937500
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1             1.900000                  1.0             2.000000                 2.00
2             0.900000                  1.0             2.000000                 1.20
3             1.466667                  1.0             1.933333                 1.60
4             0.000000                  0.0             0.000000                 0.00
5             0.000000                  0.5             2.000000                 1.00
6             0.000000                  0.0             0.000000                 0.00
7             0.125000                  1.0             2.000000                 0.25
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.875000                2.800              14.15000              8.825000
2             1.600000                2.400               5.00000              3.200000
3             1.866667                2.700              11.26667              7.533333
4             0.000000                0.000               3.00000              2.000000
5             2.000000                0.000               4.00000              0.500000
6             2.000000                0.000               3.00000              4.000000
7             1.250000                1.875               2.12500              2.625000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1                  1.9                  7.55             2.850000              19.75000
2                  0.4                  0.80             1.500000               8.40000
3                  1.0                  4.20             1.933333              12.13333
4                  0.0                  0.00             0.000000               0.00000
5                  0.0                  0.00             0.000000               0.00000
6                  0.0                  0.00             0.000000              10.00000
7                  0.0                  0.00             0.187500               0.37500
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1              12.25000              85.50000
2               7.60000              42.40000
3              10.46667              65.43333
4               0.00000               7.00000
5               0.00000              13.75000
6              15.00000              41.00000
7               0.62500              18.06250
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "Mcquitty Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #Median Link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "median")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 1 2 2 1 2 2 1 3 2 2 2 1 1 4 1 3 5 6 1 2 7 2 5 3 3 2 7 1 1 1 1 1 7 7 1 2 1 2 1 1 2
[43] 1 7 7 2 1 2 7 1 7 2
> table(clusterCut, final_grades$`Student ID`)
          
clusterCut 3 6 7 10 13 15 16 17 18 20 24 27 28 29 30 32 36 37 39 41 44 46 48 51 53 56 59
         1 1 1 0  0  1  0  0  1  0  0  0  0  1  1  0  1  0  0  0  1  0  0  0  0  0  0  0
         2 0 0 1  1  0  1  1  0  0  1  1  1  0  0  0  0  0  0  0  0  1  0  1  0  0  0  1
         3 0 0 0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  1  1  0
         4 0 0 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
         5 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
         6 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
         7 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
          
clusterCut 62 63 66 67 68 72 73 74 76 78 81 83 85 86 87 88 89 92 93 96 98 99 100 101 106
         1  0  1  1  1  1  1  0  0  1  0  1  0  1  1  0  1  0  0  0  1  0  0   1   0   0
         2  0  0  0  0  0  0  0  0  0  1  0  1  0  0  1  0  0  0  1  0  1  0   0   0   1
         3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         7  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  1  0  0  0  1   0   1   0
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1                2.0000                 3.000               1.6500
2       2                2.0000                 3.000               1.4375
3       3                1.5000                 3.000               1.5000
4       4                0.0000                 0.000               2.0000
5       5                1.7500                 1.500               0.5000
6       6                2.0000                 3.000               2.0000
7       7                1.8125                 2.875               0.9375
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1              1.90000                  1.0                 2.00                 2.00
2              1.28125                  1.0                 2.00                 1.50
3              1.50000                  1.0                 1.75                 1.50
4              0.00000                  0.0                 0.00                 0.00
5              0.00000                  0.5                 2.00                 1.00
6              0.00000                  0.0                 0.00                 0.00
7              0.12500                  1.0                 2.00                 0.25
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1                1.875              2.80000                14.150                 8.825
2                1.875              2.71875                 8.500                 6.000
3                1.500              2.25000                14.500                 8.250
4                0.000              0.00000                 3.000                 2.000
5                2.000              0.00000                 4.000                 0.500
6                2.000              0.00000                 3.000                 4.000
7                1.250              1.87500                 2.125                 2.625
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1               1.9000               7.55000               2.8500               19.7500
2               0.6875               2.65625               1.8125               10.8125
3               1.5000               6.12500               1.8750               12.7500
4               0.0000               0.00000               0.0000                0.0000
5               0.0000               0.00000               0.0000                0.0000
6               0.0000               0.00000               0.0000               10.0000
7               0.0000               0.00000               0.1875                0.3750
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1                12.250              85.50000
2                 9.625              56.90625
3                10.250              70.75000
4                 0.000               7.00000
5                 0.000              13.75000
6                15.000              41.00000
7                 0.625              18.06250
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "Median Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
> 
> #Centroid Link
> d <- dist(clustering.data)
> hclusters <- hclust(d, method = "centroid")
> clusterCut <- cutree(hclusters, 7)
> clusterCut
 [1] 1 1 2 3 1 1 3 1 3 3 2 3 1 1 4 1 3 5 6 1 3 7 1 5 3 3 3 7 1 1 1 1 1 7 7 1 3 1 2 1 1 2
[43] 1 7 7 3 1 1 7 1 7 2
> table(clusterCut, final_grades$`Student ID`)
          
clusterCut 3 6 7 10 13 15 16 17 18 20 24 27 28 29 30 32 36 37 39 41 44 46 48 51 53 56 59
         1 1 1 0  0  1  1  0  1  0  0  0  0  1  1  0  1  0  0  0  1  0  0  1  0  0  0  0
         2 0 0 1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
         3 0 0 0  1  0  0  1  0  1  1  0  1  0  0  0  0  1  0  0  0  1  0  0  0  1  1  1
         4 0 0 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0
         5 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0
         6 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0
         7 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0
          
clusterCut 62 63 66 67 68 72 73 74 76 78 81 83 85 86 87 88 89 92 93 96 98 99 100 101 106
         1  0  1  1  1  1  1  0  0  1  0  1  0  1  1  0  1  0  0  0  1  1  0   1   0   0
         2  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0   0   0   1
         3  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  0  0   0   0   0
         4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0
         7  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  1  1  0  0  0  1   0   1   0
> aggregate(final_grades[,2:18],by=list(clusterCut),mean)
  Group.1 ES 1.1 \r\n(2 points) ES 1.2 \r\n(3 points) ES 2.1\r\n(2 points)
1       1              2.000000                 3.000             1.608696
2       2              2.000000                 3.000             1.400000
3       3              1.833333                 3.000             1.500000
4       4              0.000000                 0.000             2.000000
5       5              1.750000                 1.500             0.500000
6       6              2.000000                 3.000             2.000000
7       7              1.812500                 2.875             0.937500
  ES 2.2\r\n(3 points) ES 3.1\r\n(1 points) ES 3.2\r\n(2 points) ES 3.3\r\n(2 points)
1             1.956522                  1.0             2.000000                 2.00
2             0.900000                  1.0             2.000000                 1.20
3             1.250000                  1.0             1.916667                 1.50
4             0.000000                  0.0             0.000000                 0.00
5             0.000000                  0.5             2.000000                 1.00
6             0.000000                  0.0             0.000000                 0.00
7             0.125000                  1.0             2.000000                 0.25
  ES 3.4\r\n(2 points) ES 3.5\r\n(3 points) ES 4.1\r\n(15 points) ES 4.2\r\n(10 points)
1             1.891304             2.826087              14.17391              8.847826
2             1.600000             2.400000               5.00000              3.200000
3             1.833333             2.625000              10.50000              7.166667
4             0.000000             0.000000               3.00000              2.000000
5             2.000000             0.000000               4.00000              0.500000
6             2.000000             0.000000               3.00000              4.000000
7             1.250000             1.875000               2.12500              2.625000
  ES 5.1\r\n(2 points) ES 5.2\r\n(10 points) ES 5.3\r\n(3 points) ES 6.1\r\n(25 points)
1            1.8260870              7.021739             2.695652              18.13043
2            0.4000000              0.800000             1.500000               8.40000
3            0.9166667              4.375000             2.000000              13.33333
4            0.0000000              0.000000             0.000000               0.00000
5            0.0000000              0.000000             0.000000               0.00000
6            0.0000000              0.000000             0.000000              10.00000
7            0.0000000              0.000000             0.187500               0.37500
  ES 6.2\r\n(15 points) TOTAL\r\n(100 points)
1             12.304348              83.28261
2              7.600000              42.40000
3              9.916667              64.66667
4              0.000000               7.00000
5              0.000000              13.75000
6             15.000000              41.00000
7              0.625000              18.06250
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> dend<- as.dendrogram(hclusters)
> # Vertical plot
> dend %>% set("branches_k_color", k = 7) %>% plot(main = "Centroid Cluster Dendrogram")
> dend %>% rect.dendrogram(k=7, border = 8, lty = 5, lwd = 2)
Error in rect(xleft, ybottom, xright, ytop, border = border[n], density = density,  : 
  cannot mix zero-length and non-zero-length coordinates
> 
> 
> #fviz_cluster(hclusters, data = clustering.data)
> 
> #plot(PrincipalComponent1, PrincipalComponent2, col=clusterCut)
> 
> ## Fuzzy Clustering 
> 
> #fannyx <- fanny(final_grades,7)
> #fannyx
> #summary(fannyx)
> #plot(fannyx)
> #return()
> 